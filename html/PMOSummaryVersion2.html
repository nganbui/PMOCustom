<link rel="stylesheet" href="/Style%20Library/PMOCustom/css/treeGrid.css">
<link rel="stylesheet" href="/Style%20Library/PMOCustom/css/pmo.css">

<div ng-app="PMODashboard" id="projectSummaryContent" ng-cloak>
<div ng-controller="PMOSummaryController">
<div id="projectSummaryLoader" ng-show="dataHasLoaded==false">
<h3><i class="fa fa-circle-o-notch fa-spin"></i> Loading project summary...</h3>  
</div>
<div ng-show="dataHasLoaded==true">
<h3>PMO Summary</h3>
<table class="table">
	<tbody>	
		<tr">
			<td><input type="button" value="Expand All" ng-click="my_tree.expand_all()" class="btn btn-default btn-sm" />
			<input type="button" value="Collapse All" ng-click="my_tree.collapse_all()" class="btn btn-default btn-sm" /></td>	
			<td align="right">
			<div ng-show="userhasFullControl==true">
			Filter by Project Status <select name="selectStatus"
				ng-options="item for item in projectStatus"
				ng-model="filterString" placeholder="Filter" >
			<option value="">Filter by Project Status</option>																
			</select>			
			</div>
			</td>
		</tr>    
	</tbody>
</table>    
			<tree-grid ng-if="dataHasLoaded"  tree-data="tree_data" tree-control="my_tree" col-defs="col_defs" expand-on="expanding_property" on-select="my_tree_handler(branch)" expand-level="0" icon-leaf= "glyphicon glyphicon-globe"></tree-grid>
        
</div>


<div ng-controller="PMOStatusController">
<!--<div id="statusSummaryLoader" ng-show="dataHasLoaded==false">
<h3><i class="fa fa-circle-o-notch fa-spin"></i> Loading status summary...</h3>  
</div>-->
<div ng-show="dataHasLoaded==true">
<h3>Status Summary</h3> 
<div ng-show="statusReports.length==0">Status information not found.</div>
<div ng-show="statusReports.length>0">
 <table class="table table-bordered table-striped table-condensed">
	<thead>
		<tr><th>Current Week Status Report </th><th>Project Name  <a onclick="javascript:location.reload();" href="#"><i class="fa fa-refresh"></i></a></th><th>Current Project Phase</th><th>Schedule</th><th>Budget</th><th>% Complete</th><th></th></tr>		
	</thead>
	
	<!--<tbody ng-repeat="item in statusReports | orderBy:['-StatusReport.Week','Sitename']">			-->
		<tbody dir-paginate="item in statusReports  | orderBy:['-Week','ProjectName'] | itemsPerPage:10">		
			<tr>
				<td>				
					<a ng-href="{{item.ReportUrl}}"  target="_blank">{{item.Week | date:'fullDate'}} </a>					
				</td>
				<td>
					<a ng-href="{{item.ProjectURL}}"  target="_blank">{{item.ProjectName}}</a>
				</td>
				<td>
					{{item.CurrentPhase}}
				</td>
				<td>
					{{item.Health}}
				</td>					
				<td>
					{{item.Budget}}
				</td>
				<td>
					{{item.PercentComplete}}%
				</td>
				<td>
					<a ng-href="{{item.ProjectURL}}/lists/status report"  target="_blank">More status reports</a>
				</td>
			</tr>
	</tbody>	
	<tr>
		
			<dir-pagination-controls max-size="2" direction-links="true" boundary-links="true">
             </dir-pagination-controls>
			
			</tr>
</table>
<dir-pagination-controls max-size="2" direction-links="true" boundary-links="true">
             </dir-pagination-controls>
</div>
</div>
</div>
</div>
</div>

<script type="text/javascript" src="/_layouts/15/MicrosoftAjax.js"></script>
<script type="text/javascript" src="/_layouts/15/sp.runtime.js"></script>
<script type="text/javascript" src="/_layouts/15/sp.js"></script>
<script src="http://portal.opt-osfns.org/Style%20Library/AngularJS/angular.min.js"></script>
<script src="http://portal.opt-osfns.org/Style%20Library/AngularJS/app.js"></script>       
<script src="/Style%20Library/PMOCustom/js/tree-grid-directive.js"></script>
<script src="/Style%20Library/PMOCustom/js/DashboardSummaryVersion2.js"></script>
<script type="text/javascript" src="/Style%20Library/PMOCustom/js/dirPagination.js"></script><html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"><head>
<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:_dlc_DocId msdt:dt="string">6QFQE3HAR6TF-2-630</mso:_dlc_DocId>
<mso:_dlc_DocIdItemGuid msdt:dt="string">1b2a611d-6328-4bf4-8c0d-7f006a8f5bb3</mso:_dlc_DocIdItemGuid>
<mso:_dlc_DocIdUrl msdt:dt="string">http://pmo.opt-osfns.org/_layouts/15/DocIdRedir.aspx?ID=6QFQE3HAR6TF-2-630, 6QFQE3HAR6TF-2-630</mso:_dlc_DocIdUrl>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>